{"version":3,"file":"readonly-mode.min.js","sources":["../src/readonly-mode.js"],"sourcesContent":["// jshint ignore:start\ndefine(['jquery', 'core/notification'], function($, Notification) {\n    'use strict';\n\n    /**\n     * Read-only mode functionality for Adeptus Insights plugin\n     */\n    var ReadonlyMode = {\n        \n        /**\n         * Initialize read-only mode\n         */\n        init: function() {\n            console.log('[Readonly Mode] Initializing...');\n            \n            // Listen for read-only mode enable event\n            $(document).on('adeptus:enableReadOnly', function() {\n                ReadonlyMode.enable();\n            });\n            \n            // Listen for read-only mode disable event\n            $(document).on('adeptus:disableReadOnly', function() {\n                ReadonlyMode.disable();\n            });\n            \n            // Check if we should start in read-only mode\n            if (window.adeptusAuthData) {\n                ReadonlyMode.checkInitialState();\n            }\n        },\n        \n        /**\n         * Check initial state and enable read-only if needed\n         */\n        checkInitialState: function() {\n            var authData = window.adeptusAuthData;\n            var shouldEnableReadOnly = !authData || \n                                     !authData.user_authorized || \n                                     !authData.has_api_key || \n                                     (authData.auth_errors && authData.auth_errors > 0);\n            \n            if (shouldEnableReadOnly) {\n                console.log('[Readonly Mode] Enabling readonly mode');\n                this.enable();\n            }\n        },\n        \n        /**\n         * Enable read-only mode\n         */\n        enable: function() {\n            console.log('[Readonly Mode] Enabling readonly mode');\n            \n            // Add read-only class to body\n            $('body').addClass('adeptus-readonly-mode');\n            \n            // Disable all interactive elements\n            this.disableInteractiveElements();\n            \n            // Show read-only notification\n            this.showReadOnlyNotification();\n            \n            // Disable forms\n            this.disableForms();\n            \n            // Disable buttons\n            this.disableButtons();\n            \n            // Trigger custom event\n            $(document).trigger('adeptus:readOnlyEnabled');\n        },\n        \n        /**\n         * Disable read-only mode\n         */\n        disable: function() {\n            console.log('[Readonly Mode] Disabling readonly mode');\n            \n            // Remove read-only class from body\n            $('body').removeClass('adeptus-readonly-mode');\n            \n            // Re-enable all interactive elements\n            this.enableInteractiveElements();\n            \n            // Hide read-only notification\n            this.hideReadOnlyNotification();\n            \n            // Re-enable forms\n            this.enableForms();\n            \n            // Re-enable buttons\n            this.enableButtons();\n            \n            // Trigger custom event\n            $(document).trigger('adeptus:readOnlyDisabled');\n        },\n        \n        /**\n         * Disable interactive elements\n         */\n        disableInteractiveElements: function() {\n            // Disable inputs, textareas, selects\n            $('input, textarea, select').prop('disabled', true);\n            \n            // Disable links that are not navigation\n            $('a:not(.nav-link):not(.breadcrumb-item a)').addClass('disabled').css('pointer-events', 'none');\n            \n            // Disable buttons\n            $('button:not(.nav-toggle)').prop('disabled', true);\n            \n            // Disable form submissions\n            $('form').on('submit.adeptus-readonly', function(e) {\n                e.preventDefault();\n                return false;\n            });\n        },\n        \n        /**\n         * Enable interactive elements\n         */\n        enableInteractiveElements: function() {\n            // Re-enable inputs, textareas, selects\n            $('input, textarea, select').prop('disabled', false);\n            \n            // Re-enable links\n            $('a.disabled').removeClass('disabled').css('pointer-events', '');\n            \n            // Re-enable buttons\n            $('button').prop('disabled', false);\n            \n            // Re-enable form submissions\n            $('form').off('submit.adeptus-readonly');\n        },\n        \n        /**\n         * Disable forms\n         */\n        disableForms: function() {\n            $('form').each(function() {\n                var $form = $(this);\n                if (!$form.data('adeptus-original-action')) {\n                    $form.data('adeptus-original-action', $form.attr('action'));\n                    $form.attr('action', 'javascript:void(0)');\n                }\n            });\n        },\n        \n        /**\n         * Enable forms\n         */\n        enableForms: function() {\n            $('form').each(function() {\n                var $form = $(this);\n                var originalAction = $form.data('adeptus-original-action');\n                if (originalAction) {\n                    $form.attr('action', originalAction);\n                    $form.removeData('adeptus-original-action');\n                }\n            });\n        },\n        \n        /**\n         * Disable buttons\n         */\n        disableButtons: function() {\n            $('button:not(.nav-toggle)').each(function() {\n                var $btn = $(this);\n                if (!$btn.data('adeptus-original-text')) {\n                    $btn.data('adeptus-original-text', $btn.text());\n                    $btn.text('Read-Only Mode');\n                    $btn.addClass('btn-secondary').removeClass('btn-primary btn-success btn-danger btn-warning btn-info');\n                }\n            });\n        },\n        \n        /**\n         * Enable buttons\n         */\n        enableButtons: function() {\n            $('button').each(function() {\n                var $btn = $(this);\n                var originalText = $btn.data('adeptus-original-text');\n                if (originalText) {\n                    $btn.text(originalText);\n                    $btn.removeData('adeptus-original-text');\n                    $btn.removeClass('btn-secondary');\n                }\n            });\n        },\n        \n        /**\n         * Show read-only notification\n         */\n        showReadOnlyNotification: function() {\n            if (Notification) {\n                this.readOnlyNotification = Notification.addNotification({\n                    message: 'Plugin is in read-only mode due to authentication issues',\n                    type: 'warning',\n                    closebutton: false\n                });\n            } else {\n                // Fallback to alert if Notification is not available\n                if (!this.readOnlyAlertShown) {\n                    alert('Plugin is in read-only mode due to authentication issues');\n                    this.readOnlyAlertShown = true;\n                }\n            }\n        },\n        \n        /**\n         * Hide read-only notification\n         */\n        hideReadOnlyNotification: function() {\n            if (this.readOnlyNotification && Notification) {\n                Notification.closeNotification(this.readOnlyNotification);\n                this.readOnlyNotification = null;\n            }\n            this.readOnlyAlertShown = false;\n        },\n        \n        /**\n         * Check if read-only mode is active\n         */\n        isEnabled: function() {\n            return $('body').hasClass('adeptus-readonly-mode');\n        }\n    };\n\n    return ReadonlyMode;\n});\n"],"names":["define","$","Notification","ReadonlyMode","init","console","log","document","on","enable","disable","window","adeptusAuthData","checkInitialState","authData","user_authorized","has_api_key","auth_errors","addClass","disableInteractiveElements","showReadOnlyNotification","disableForms","disableButtons","trigger","removeClass","enableInteractiveElements","hideReadOnlyNotification","enableForms","enableButtons","prop","css","e","preventDefault","off","each","$form","this","data","attr","originalAction","removeData","$btn","text","originalText","readOnlyNotification","addNotification","message","type","closebutton","readOnlyAlertShown","alert","closeNotification","isEnabled","hasClass"],"mappings":"AACAA,+CAAO,CAAC,SAAU,sBAAsB,SAASC,EAAGC,kBAM5CC,aAAe,CAKfC,KAAM,WACFC,QAAQC,IAAI,mCAGZL,EAAEM,UAAUC,GAAG,0BAA0B,WACrCL,aAAaM,YAIjBR,EAAEM,UAAUC,GAAG,2BAA2B,WACtCL,aAAaO,aAIbC,OAAOC,iBACPT,aAAaU,qBAOrBA,kBAAmB,eACXC,SAAWH,OAAOC,kBACME,WACFA,SAASC,kBACTD,SAASE,aACTF,SAASG,aAAeH,SAASG,YAAc,KAGrEZ,QAAQC,IAAI,+CACPG,WAObA,OAAQ,WACJJ,QAAQC,IAAI,0CAGZL,EAAE,QAAQiB,SAAS,8BAGdC,kCAGAC,gCAGAC,oBAGAC,iBAGLrB,EAAEM,UAAUgB,QAAQ,4BAMxBb,QAAS,WACLL,QAAQC,IAAI,2CAGZL,EAAE,QAAQuB,YAAY,8BAGjBC,iCAGAC,gCAGAC,mBAGAC,gBAGL3B,EAAEM,UAAUgB,QAAQ,6BAMxBJ,2BAA4B,WAExBlB,EAAE,2BAA2B4B,KAAK,YAAY,GAG9C5B,EAAE,4CAA4CiB,SAAS,YAAYY,IAAI,iBAAkB,QAGzF7B,EAAE,2BAA2B4B,KAAK,YAAY,GAG9C5B,EAAE,QAAQO,GAAG,2BAA2B,SAASuB,UAC7CA,EAAEC,kBACK,MAOfP,0BAA2B,WAEvBxB,EAAE,2BAA2B4B,KAAK,YAAY,GAG9C5B,EAAE,cAAcuB,YAAY,YAAYM,IAAI,iBAAkB,IAG9D7B,EAAE,UAAU4B,KAAK,YAAY,GAG7B5B,EAAE,QAAQgC,IAAI,4BAMlBZ,aAAc,WACVpB,EAAE,QAAQiC,MAAK,eACPC,MAAQlC,EAAEmC,MACTD,MAAME,KAAK,6BACZF,MAAME,KAAK,0BAA2BF,MAAMG,KAAK,WACjDH,MAAMG,KAAK,SAAU,2BAQjCX,YAAa,WACT1B,EAAE,QAAQiC,MAAK,eACPC,MAAQlC,EAAEmC,MACVG,eAAiBJ,MAAME,KAAK,2BAC5BE,iBACAJ,MAAMG,KAAK,SAAUC,gBACrBJ,MAAMK,WAAW,gCAQ7BlB,eAAgB,WACZrB,EAAE,2BAA2BiC,MAAK,eAC1BO,KAAOxC,EAAEmC,MACRK,KAAKJ,KAAK,2BACXI,KAAKJ,KAAK,wBAAyBI,KAAKC,QACxCD,KAAKC,KAAK,kBACVD,KAAKvB,SAAS,iBAAiBM,YAAY,gEAQvDI,cAAe,WACX3B,EAAE,UAAUiC,MAAK,eACTO,KAAOxC,EAAEmC,MACTO,aAAeF,KAAKJ,KAAK,yBACzBM,eACAF,KAAKC,KAAKC,cACVF,KAAKD,WAAW,yBAChBC,KAAKjB,YAAY,sBAQ7BJ,yBAA0B,WAClBlB,kBACK0C,qBAAuB1C,aAAa2C,gBAAgB,CACrDC,QAAS,2DACTC,KAAM,UACNC,aAAa,IAIZZ,KAAKa,qBACNC,MAAM,iEACDD,oBAAqB,IAQtCvB,yBAA0B,WAClBU,KAAKQ,sBAAwB1C,eAC7BA,aAAaiD,kBAAkBf,KAAKQ,2BAC/BA,qBAAuB,WAE3BK,oBAAqB,GAM9BG,UAAW,kBACAnD,EAAE,QAAQoD,SAAS,kCAI3BlD"}