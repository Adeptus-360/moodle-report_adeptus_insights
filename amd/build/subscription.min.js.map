{"version":3,"file":"subscription.min.js","sources":["../src/subscription.js"],"sourcesContent":["// jshint ignore:start\ndefine(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n    'use strict';\n\n    var Swal = window.Swal;\n\n    /**\n     * Subscription management for Adeptus Insights plugin\n     */\n    var Subscription = {\n        planId: 0,\n        subscriptionData: {},\n        /**\n         * Initialize subscription functionality\n         */\n        init: function() {\n            console.log('[Subscription] Initializing...');\n            \n            // Initialize event handlers\n            this.initEventHandlers();\n            \n            // Initialize subscription display\n            this.updateSubscriptionDisplay();\n        },\n        \n        /**\n         * Initialize event handlers\n         */\n        initEventHandlers: function() {\n            console.log('[Subscription] Setting up event handlers...');\n            \n            // Handle upgrade plan buttons\n            $(document).on('click', '.btn-upgrade-plan', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Upgrade button clicked');\n                Subscription.handleUpgradePlan($(this));\n            });\n            \n            // Handle downgrade plan buttons\n            $(document).on('click', '.btn-downgrade-plan', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Downgrade button clicked');\n                Subscription.handleDowngradePlan($(this));\n            });\n            \n            // Handle cancel subscription buttons\n            $(document).on('click', '.btn-cancel-subscription, #cancel-subscription', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Cancel subscription button clicked');\n                Subscription.handleCancelSubscription($(this));\n            });\n            \n            // Handle billing portal access\n            $(document).on('click', '.btn-billing-portal', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Billing portal button clicked');\n                Subscription.openBillingPortal();\n            });\n            \n            // Handle modify subscription button\n            $(document).on('click', '.btn-modify-subscription, #modify-subscription', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Modify subscription button clicked');\n                Subscription.openBillingPortal();\n            });\n            \n            // Handle view plans button (open billing portal)\n            $(document).on('click', '.btn-view-plans, #view-plans', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] View plans button clicked');\n                Subscription.openBillingPortal();\n            });\n\n            // Handle upgrade plan button (for free plan users)\n            $(document).on('click', '.btn-upgrade-plan, #upgrade-plan', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Upgrade plan button clicked');\n                Subscription.handleUpgradeFromFree();\n            });\n            \n            // Handle select plan button (new subscriptions)\n            $(document).on('click', '.select-plan-btn', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Select plan button clicked');\n                var planId = $(this).data('plan-id');\n                var planName = $(this).data('plan-name');\n                Subscription.handleSelectPlan($(this), planId, planName);\n            });\n            \n            // Handle renew subscription button\n            $(document).on('click', '#renew-subscription', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Renew subscription button clicked');\n                Subscription.handleRenewSubscription();\n            });\n            \n            // Handle update payment button\n            $(document).on('click', '#update-payment', function(e) {\n                e.preventDefault();\n                console.log('[Subscription] Update payment button clicked');\n                Subscription.openBillingPortal();\n            });\n            \n            console.log('[Subscription] Event handlers setup complete');\n        },\n        \n        /**\n         * Handle upgrade plan\n         */\n        handleUpgradePlan: function($button) {\n            var planId = $button.data('plan-id');\n            var planName = $button.data('plan-name');\n            \n            console.log('[Subscription] handleUpgradePlan called with planId:', planId, 'planName:', planName);\n            \n            if (!planId) {\n                console.error('[Subscription] No plan ID available');\n                Swal.fire({\n                    icon: 'error',\n                    title: 'Error',\n                    text: 'Plan ID not available. Please try again.',\n                    confirmButtonColor: '#3085d6'\n                });\n                return;\n            }\n            \n            // Show confirmation dialog\n            Swal.fire({\n                icon: 'question',\n                title: 'Upgrade to ' + planName + '?',\n                html: '<p>You will be redirected to the billing portal to complete the upgrade.</p>',\n                showCancelButton: true,\n                confirmButtonColor: '#f39c12',\n                cancelButtonColor: '#95a5a6',\n                confirmButtonText: '<i class=\"fa fa-arrow-up\"></i> Upgrade',\n                cancelButtonText: 'Cancel'\n            }).then(function(result) {\n                if (result.isConfirmed) {\n                    console.log('[Subscription] User confirmed upgrade to plan:', planId);\n                    Subscription.createBillingPortalSession(planId, 'upgrade');\n                } else {\n                    console.log('[Subscription] User cancelled upgrade');\n                }\n            });\n        },\n        \n        /**\n         * Handle downgrade plan\n         */\n        handleDowngradePlan: function($button) {\n            var planId = $button.data('plan-id');\n            var planName = $button.data('plan-name');\n            \n            console.log('[Subscription] handleDowngradePlan called with planId:', planId, 'planName:', planName);\n            \n            if (!planId) {\n                console.error('[Subscription] No plan ID available');\n                Swal.fire({\n                    icon: 'error',\n                    title: 'Error',\n                    text: 'Plan ID not available. Please try again.',\n                    confirmButtonColor: '#3085d6'\n                });\n                return;\n            }\n            \n            // Show confirmation dialog\n            Swal.fire({\n                icon: 'warning',\n                title: 'Downgrade to ' + planName + '?',\n                html: '<p>You will be redirected to the billing portal to complete the downgrade.</p>' +\n                      '<p class=\"text-muted\"><small>Your current plan features will remain active until the end of the billing period.</small></p>',\n                showCancelButton: true,\n                confirmButtonColor: '#17a2b8',\n                cancelButtonColor: '#95a5a6',\n                confirmButtonText: '<i class=\"fa fa-arrow-down\"></i> Downgrade',\n                cancelButtonText: 'Cancel'\n            }).then(function(result) {\n                if (result.isConfirmed) {\n                    console.log('[Subscription] User confirmed downgrade to plan:', planId);\n                    Subscription.createBillingPortalSession(planId, 'downgrade');\n                } else {\n                    console.log('[Subscription] User cancelled downgrade');\n                }\n            });\n        },\n        \n        /**\n         * Handle cancel subscription\n         */\n        handleCancelSubscription: function($button) {\n            Swal.fire({\n                icon: 'warning',\n                title: 'Cancel Subscription?',\n                html: '<p><strong>Are you sure you want to cancel your subscription?</strong></p>' +\n                      '<p>You will lose access to premium features at the end of your billing period.</p>' +\n                      '<p class=\"text-danger\"><small>This action cannot be undone.</small></p>',\n                showCancelButton: true,\n                confirmButtonColor: '#e74c3c',\n                cancelButtonColor: '#95a5a6',\n                confirmButtonText: '<i class=\"fa fa-times\"></i> Yes, Cancel Subscription',\n                cancelButtonText: 'Keep Subscription',\n                focusCancel: true\n            }).then(function(result) {\n                if (result.isConfirmed) {\n                    console.log('[Subscription] User confirmed cancellation');\n                    Subscription.createBillingPortalSession(null, 'cancel');\n                } else {\n                    console.log('[Subscription] User kept subscription');\n                }\n            });\n        },\n        \n        /**\n         * Open billing portal\n         */\n        openBillingPortal: function() {\n            console.log('[Subscription] Opening billing portal...');\n            Subscription.createBillingPortalSession(Subscription.subscriptionData.plan_id, 'modify');\n        },\n        \n        /**\n         * Create billing portal session\n         */\n        createBillingPortalSession: function(planId, action) {\n            console.log('[Subscription] Creating billing portal session...', {planId, action});\n            var returnUrl = window.location.href;\n            var data = {\n                return_url: returnUrl,\n                sesskey: M.cfg.sesskey\n            };\n            \n            // Only add plan_id and action if they are defined and not null\n            if (planId && planId !== 'undefined' && planId !== null) {\n                data.plan_id = planId;\n            }\n            \n            if (action && action !== 'undefined' && action !== null) {\n                data.action = action;\n            }\n            \n            console.log('[Subscription] Sending data:', data);\n            \n            Ajax.call([{\n                methodname: 'report_adeptus_insights_create_billing_portal_session',\n                args: data,\n                done: function(response) {\n                    console.log('[Subscription] AJAX response:', response);\n                    console.log('[Subscription] Response success:', response?.success);\n                    console.log('[Subscription] Response portal_url:', response?.portal_url);\n                    \n                    if (response && response.success && response.portal_url) {\n                        console.log('[Subscription] Redirecting to portal URL:', response.portal_url);\n                        \n                        Swal.fire({\n                            icon: 'success',\n                            title: 'Redirecting...',\n                            html: '<p>Opening billing portal in a new window...</p>',\n                            timer: 2000,\n                            timerProgressBar: true,\n                            showConfirmButton: false,\n                            allowOutsideClick: false,\n                            didOpen: function() {\n                                Swal.showLoading();\n                            }\n                        });\n                        \n                        // Open in new tab\n                        setTimeout(function() {\n                            var newWindow = window.open(response.portal_url, '_blank');\n                            if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {\n                                Swal.fire({\n                                    icon: 'warning',\n                                    title: 'Popup Blocked',\n                                    html: '<p>Please allow popups for this site and try again.</p>' +\n                                          '<p><a href=\"' + response.portal_url + '\" target=\"_blank\" class=\"btn btn-primary\">Open Portal Manually</a></p>',\n                                    showConfirmButton: true,\n                                    confirmButtonText: 'OK'\n                                });\n                            }\n                        }, 1000);\n                    } else {\n                        console.log('[Subscription] Portal creation failed:', response);\n                        Swal.fire({\n                            icon: 'error',\n                            title: 'Portal Creation Failed',\n                            text: response?.message || 'Failed to create billing portal session. Please try again.',\n                            confirmButtonColor: '#3085d6'\n                        });\n                    }\n                },\n                fail: function(error) {\n                    console.error('[Subscription] AJAX failed:', error);\n                    Swal.fire({\n                        icon: 'error',\n                        title: 'Connection Error',\n                        text: 'Failed to create billing portal session. Please check your connection and try again.',\n                        confirmButtonColor: '#3085d6'\n                    });\n                }\n            }]);\n        },\n        \n        /**\n         * Update subscription display\n         */\n        updateSubscriptionDisplay: function() {\n            // Get current subscription data\n            Ajax.call([{\n                methodname: 'report_adeptus_insights_get_subscription_details',\n                args: {},\n                done: function(response) {\n                    if (response.success && response.data) {\n                        console.log('[Subscription] Full AJAX response:', response);\n                        console.log('[Subscription] Response data keys:', Object.keys(response.data || {}));\n                        console.log('[Subscription] Plan ID in data:', response.data.plan_id);\n                        console.log('[Subscription] Subscription data:', response.data);\n                        Subscription.subscriptionData = response.data;\n                        Subscription.renderSubscriptionInfo(response.data);\n                    }\n                },\n                fail: function(error) {\n                    console.error('[Subscription] Failed to get subscription details:', error);\n                }\n            }]);\n        },\n        \n        /**\n         * Render subscription information\n         */\n        renderSubscriptionInfo: function(subscriptionData) {\n            var $container = $('.subscription-info');\n            if (!$container.length) return;\n            \n            var html = '<div class=\"current-subscription\">';\n            html += '<h3>Current Subscription</h3>';\n            html += '<div class=\"subscription-details\">';\n            html += '<p><strong>Plan:</strong> ' + (subscriptionData.plan_name || 'Unknown') + '</p>';\n            \n            // Display status with appropriate styling and messaging\n            var statusClass = 'text-success';\n            var statusText = subscriptionData.status || 'Unknown';\n            \n            if (subscriptionData.should_disable_api_access) {\n                statusClass = 'text-danger';\n            } else if (subscriptionData.is_cancelled) {\n                statusClass = 'text-warning';\n            } else if (subscriptionData.has_payment_issues) {\n                statusClass = 'text-warning';\n            }\n            \n            html += '<p><strong>Status:</strong> <span class=\"' + statusClass + '\">' + statusText + '</span></p>';\n            \n            // Display status message if available\n            if (subscriptionData.status_message) {\n                var messageClass = 'text-muted';\n                if (subscriptionData.should_disable_api_access) {\n                    messageClass = 'text-danger';\n                } else if (subscriptionData.is_cancelled || subscriptionData.has_payment_issues) {\n                    messageClass = 'text-warning';\n                }\n                html += '<p class=\"' + messageClass + '\"><small>' + subscriptionData.status_message + '</small></p>';\n            }\n            \n            // Show cancellation info\n            if (subscriptionData.cancel_at_period_end) {\n                var cancelDate = new Date(subscriptionData.current_period_end * 1000);\n                html += '<p class=\"text-warning\"><strong>⚠️ Cancelled:</strong> Access ends on ' + cancelDate.toLocaleDateString() + '</p>';\n            }\n            \n            // Show payment failure info\n            if (subscriptionData.failed_payment_attempts > 0) {\n                html += '<p class=\"text-danger\"><strong>❌ Payment Failed:</strong> ' + subscriptionData.failed_payment_attempts + ' failed attempts</p>';\n            }\n            \n            if (subscriptionData.current_period_end) {\n                var endDate = new Date(subscriptionData.current_period_end * 1000);\n                html += '<p><strong>Next billing:</strong> ' + endDate.toLocaleDateString() + '</p>';\n            }\n            \n            html += '</div>';\n            html += '</div>';\n            \n            $container.html(html);\n            \n            // Update API access status globally\n            Subscription.updateApiAccessStatus(subscriptionData);\n        },\n        \n        /**\n         * Update API access status globally\n         */\n        updateApiAccessStatus: function(subscriptionData) {\n            var apiAccessDisabled = subscriptionData.should_disable_api_access || false;\n            \n            // Store the status globally for other modules to check\n            if (typeof window !== 'undefined') {\n                window.adeptusApiAccessDisabled = apiAccessDisabled;\n                window.adeptusSubscriptionStatus = subscriptionData;\n            }\n            \n            // Disable/enable API-dependent elements\n            if (apiAccessDisabled) {\n                $('.btn-send-message, .btn-generate-report, .btn-ai-assistant').prop('disabled', true)\n                    .attr('title', 'API access disabled: ' + (subscriptionData.status_message || 'Subscription issue'));\n                \n                // Show warning message\n                this.showApiAccessWarning(subscriptionData);\n            } else {\n                $('.btn-send-message, .btn-generate-report, .btn-ai-assistant').prop('disabled', false)\n                    .removeAttr('title');\n                \n                // Hide warning message\n                this.hideApiAccessWarning();\n            }\n        },\n        \n        /**\n         * Show API access warning\n         */\n        showApiAccessWarning: function(subscriptionData) {\n            var $existingWarning = $('.api-access-warning');\n            if ($existingWarning.length) return;\n            \n            var warningHtml = '<div class=\"api-access-warning alert alert-danger alert-dismissible fade show\" role=\"alert\">';\n            warningHtml += '<strong>⚠️ API Access Disabled</strong><br>';\n            warningHtml += subscriptionData.status_message || 'Your subscription has an issue that prevents API access.';\n            \n            if (subscriptionData.has_payment_issues) {\n                warningHtml += '<br><small>Please update your payment method to restore access.</small>';\n            } else if (subscriptionData.is_cancelled) {\n                warningHtml += '<br><small>Your subscription has been cancelled. Please reactivate to restore access.</small>';\n            }\n            \n            warningHtml += '<button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"></button>';\n            warningHtml += '</div>';\n            \n            $('body').prepend(warningHtml);\n        },\n        \n        /**\n         * Hide API access warning\n         */\n        hideApiAccessWarning: function() {\n            $('.api-access-warning').remove();\n        },\n        \n        /**\n         * Refresh subscription data\n         */\n        refresh: function() {\n            this.updateSubscriptionDisplay();\n        },\n        \n        /**\n         * Handle upgrade from free plan\n         */\n        handleUpgradeFromFree: function() {\n            console.log('[Subscription] handleUpgradeFromFree called');\n\n            Swal.fire({\n                icon: 'info',\n                title: 'Upgrade Your Plan',\n                html: '<p>You will be redirected to our billing portal where you can choose a premium plan with more features.</p>',\n                showCancelButton: true,\n                confirmButtonColor: '#27ae60',\n                cancelButtonColor: '#95a5a6',\n                confirmButtonText: '<i class=\"fa fa-arrow-up\"></i> View Plans & Upgrade',\n                cancelButtonText: 'Not Now'\n            }).then(function(result) {\n                if (result.isConfirmed) {\n                    console.log('[Subscription] User confirmed upgrade from free');\n                    Subscription.createBillingPortalSession(null, 'upgrade');\n                } else {\n                    console.log('[Subscription] User cancelled upgrade');\n                }\n            });\n        },\n        \n        /**\n         * Handle select plan (for new subscriptions)\n         */\n        handleSelectPlan: function($button, planId, planName) {\n            console.log('[Subscription] handleSelectPlan called with planId:', planId, 'planName:', planName);\n            \n            if (!planId) {\n                console.error('[Subscription] No plan ID available');\n                Swal.fire({\n                    icon: 'error',\n                    title: 'Error',\n                    text: 'Plan ID not available. Please try again.',\n                    confirmButtonColor: '#3085d6'\n                });\n                return;\n            }\n            \n            // Show confirmation dialog\n            Swal.fire({\n                icon: 'info',\n                title: 'Subscribe to ' + planName + '?',\n                html: '<p>You will be redirected to complete your subscription.</p>',\n                showCancelButton: true,\n                confirmButtonColor: '#3498db',\n                cancelButtonColor: '#95a5a6',\n                confirmButtonText: '<i class=\"fa fa-credit-card\"></i> Subscribe Now',\n                cancelButtonText: 'Cancel'\n            }).then(function(result) {\n                if (result.isConfirmed) {\n                    console.log('[Subscription] User confirmed subscription to plan:', planId);\n                    Subscription.createBillingPortalSession(planId, 'subscribe');\n                } else {\n                    console.log('[Subscription] User cancelled subscription');\n                }\n            });\n        },\n        \n        /**\n         * Handle renew subscription\n         */\n        handleRenewSubscription: function() {\n            console.log('[Subscription] handleRenewSubscription called');\n            \n            Swal.fire({\n                icon: 'success',\n                title: 'Renew Your Subscription?',\n                html: '<p>Welcome back! Renew your subscription to regain access to all premium features.</p>',\n                showCancelButton: true,\n                confirmButtonColor: '#27ae60',\n                cancelButtonColor: '#95a5a6',\n                confirmButtonText: '<i class=\"fa fa-refresh\"></i> Renew Subscription',\n                cancelButtonText: 'Not Now'\n            }).then(function(result) {\n                if (result.isConfirmed) {\n                    console.log('[Subscription] User confirmed renewal');\n                    // Open billing portal for renewal\n                    Subscription.createBillingPortalSession(null, 'renew');\n                } else {\n                    console.log('[Subscription] User cancelled renewal');\n                }\n            });\n        }\n    };\n\n    return Subscription;\n});\n"],"names":["define","$","Ajax","Notification","Swal","window","Subscription","planId","subscriptionData","init","console","log","initEventHandlers","updateSubscriptionDisplay","document","on","e","preventDefault","handleUpgradePlan","this","handleDowngradePlan","handleCancelSubscription","openBillingPortal","handleUpgradeFromFree","data","planName","handleSelectPlan","handleRenewSubscription","$button","error","fire","icon","title","text","confirmButtonColor","html","showCancelButton","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","isConfirmed","createBillingPortalSession","focusCancel","plan_id","action","return_url","location","href","sesskey","M","cfg","call","methodname","args","done","response","success","portal_url","timer","timerProgressBar","showConfirmButton","allowOutsideClick","didOpen","showLoading","setTimeout","newWindow","open","closed","message","fail","Object","keys","renderSubscriptionInfo","$container","length","plan_name","statusClass","statusText","status","should_disable_api_access","is_cancelled","has_payment_issues","status_message","messageClass","cancel_at_period_end","Date","current_period_end","toLocaleDateString","failed_payment_attempts","updateApiAccessStatus","apiAccessDisabled","adeptusApiAccessDisabled","adeptusSubscriptionStatus","prop","attr","showApiAccessWarning","removeAttr","hideApiAccessWarning","warningHtml","prepend","remove","refresh"],"mappings":"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"}