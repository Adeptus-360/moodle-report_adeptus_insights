/**
 * Authentication utilities for Adeptus Insights plugin.
 *
 * Provides helper functions for managing authentication state, checking
 * authorization status, and handling read-only mode based on auth status.
 *
 * @module     report_adeptus_insights/auth_utils
 * @copyright  2026 Adeptus 360 <info@adeptus360.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("report_adeptus_insights/auth_utils",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){return{initializeFromMoodle:function(authData){authData&&(authData.subscription&&(void 0!==authData.subscription.ai_credits_used_this_month&&(authData.subscription.total_credits_used_this_month=authData.subscription.ai_credits_used_this_month),void 0!==authData.subscription.plan_ai_credits_limit&&(authData.subscription.plan_total_credits_limit=authData.subscription.plan_ai_credits_limit),authData.plan&&authData.plan.ai_credits&&(authData.subscription.plan_total_credits_limit=authData.plan.ai_credits)),window.adeptusAuthData=authData,this.checkReadOnlyMode(authData),this.initializeAuthFeatures(authData))},checkReadOnlyMode:function(authData){(!authData||!authData.user_authorized||!authData.has_api_key||authData.auth_errors&&authData.auth_errors>0)&&$(document).trigger("adeptus:enableReadOnly")},initializeAuthFeatures:function(authData){authData&&authData.user_authorized&&authData.has_api_key&&($(document).trigger("adeptus:enableInteractiveFeatures"),void 0!==window.AdeptusAI&&window.AdeptusAI.init())},isAuthenticated:function(){return window.adeptusAuthData&&window.adeptusAuthData.user_authorized&&window.adeptusAuthData.has_api_key},getAuthData:function(){return window.adeptusAuthData||null},getAuthStatus:function(){return window.adeptusAuthData||null},getAuthHeaders:function(){var authData=this.getAuthData();return authData&&authData.api_key?{Authorization:"Bearer "+authData.api_key,"X-API-Key":authData.api_key}:{}},setAuthStatus:function(authData){authData&&(authData.subscription&&(void 0!==authData.subscription.ai_credits_used_this_month&&(authData.subscription.total_credits_used_this_month=authData.subscription.ai_credits_used_this_month),void 0!==authData.subscription.plan_ai_credits_limit&&(authData.subscription.plan_total_credits_limit=authData.subscription.plan_ai_credits_limit),authData.plan&&authData.plan.ai_credits&&(authData.subscription.plan_total_credits_limit=authData.plan.ai_credits)),window.adeptusAuthData=authData)},clearAuthData:function(){window.adeptusAuthData=null},showAuthError:function(message){var errorMsg=message||"Authentication required";Notification?Notification.addNotification({message:errorMsg,type:"error"}):Notification.alert("Authentication Error",errorMsg)},refreshAuthStatus:function(){}}}));

//# sourceMappingURL=auth_utils.min.js.map