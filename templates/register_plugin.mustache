{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template   report_adeptus_insights/register_plugin

    Plugin registration template providing a clean, professional interface for
    registering the Adeptus Insights plugin with the backend service.

    CSS is loaded from: styles/register.css
    JS is loaded from: amd/src/register_plugin.js (via PHP)

    @package    report_adeptus_insights
    @copyright  2026 Adeptus 360 <info@adeptus360.com>
    @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
}}

<div class="adeptus-registration-container adeptus-installation-container">
    {{#is_registered}}
    <!-- Already Registered - Congratulations View -->
    <div class="adeptus-success-header">
        <h1><i class="fa fa-check-circle"></i> {{#str}}congratulations, report_adeptus_insights{{/str}}</h1>
        <p>{{#str}}plugin_connected_ready, report_adeptus_insights{{/str}}</p>
    </div>

    <div class="adeptus-success-content">
        <div class="adeptus-success-card">
            <div class="adeptus-success-icon">
                <i class="fa fa-link"></i>
            </div>
            <h3>{{#str}}connection_status, report_adeptus_insights{{/str}}</h3>
            <div class="adeptus-connection-details">
                <div class="adeptus-detail-row">
                    <span class="label">{{#str}}installation_id, report_adeptus_insights{{/str}}:</span>
                    <span class="value">{{installation_id}}</span>
                </div>
                <div class="adeptus-detail-row">
                    <span class="label">{{#str}}api_key, report_adeptus_insights{{/str}}:</span>
                    <span class="value">{{api_key}}</span>
                </div>
                <div class="adeptus-detail-row">
                    <span class="label">{{#str}}site_name_label, report_adeptus_insights{{/str}}:</span>
                    <span class="value">{{site_name}}</span>
                </div>
                <div class="adeptus-detail-row">
                    <span class="label">{{#str}}status, report_adeptus_insights{{/str}}:</span>
                    <span class="value adeptus-status-connected">{{#str}}connected, report_adeptus_insights{{/str}}</span>
                </div>
            </div>
        </div>

        <div class="adeptus-action-buttons">
            <a href="{{site_url}}/report/adeptus_insights/index.php" class="adeptus-btn-primary">
                <i class="fa fa-dashboard"></i> {{#str}}go_to_dashboard, report_adeptus_insights{{/str}}
            </a>
            <a href="{{site_url}}/report/adeptus_insights/subscription.php" class="adeptus-btn-secondary">
                <i class="fa fa-credit-card"></i> {{#str}}manage_subscription, report_adeptus_insights{{/str}}
            </a>
        </div>
    </div>
    {{/is_registered}}

    {{^is_registered}}
    <!-- Not Registered - Registration Form -->
    {{#error_message}}
    <div class="adeptus-error adeptus-visible">
        <strong>{{#str}}registration_error, report_adeptus_insights{{/str}}:</strong> {{error_message}}
    </div>
    {{/error_message}}

    {{#site_already_exists}}
    <div class="adeptus-info-box adeptus-site-exists">
        <strong><i class="fa fa-info-circle"></i> {{#str}}site_already_registered, report_adeptus_insights{{/str}}:</strong>
        {{#str}}site_already_registered_desc, report_adeptus_insights{{/str}}
    </div>
    {{/site_already_exists}}

    <!-- Installation Header -->
    <div class="adeptus-installation-header">
       <h1><i class="fa fa-rocket"></i> {{#str}}adeptus_insights_registration, report_adeptus_insights{{/str}}</h1>
        <p>{{#str}}complete_registration_activate, report_adeptus_insights{{/str}}</p>
    </div>

    <!-- Installation Progress -->
    <div class="adeptus-installation-progress">
        <div class="adeptus-progress-step current">
            <div class="adeptus-step-number">1</div>
            <div class="adeptus-step-label">{{#str}}step_plugin_registration, report_adeptus_insights{{/str}}</div>
        </div>
        <div class="adeptus-progress-connector"></div>
        <div class="adeptus-progress-step pending">
            <div class="adeptus-step-number">2</div>
            <div class="adeptus-step-label">{{#str}}step_subscription_setup, report_adeptus_insights{{/str}}</div>
        </div>
        <div class="adeptus-progress-connector"></div>
        <div class="adeptus-progress-step pending">
            <div class="adeptus-step-number">3</div>
            <div class="adeptus-step-label">{{#str}}step_installation_complete, report_adeptus_insights{{/str}}</div>
        </div>
    </div>

    <div class="adeptus-error" id="validation-error">
        <strong>{{#str}}missing_required_information, report_adeptus_insights{{/str}}</strong> <span id="validation-message"></span>
    </div>


    <form method="post" class="adeptus-registration-form" id="registration-form">
        <input type="hidden" name="sesskey" value="{{sesskey}}">
        <input type="hidden" name="action" value="register">

        <!-- Site Information Section -->
        <div class="adeptus-form-section">
            <h3><i class="fa fa-globe"></i> {{#str}}site_information, report_adeptus_insights{{/str}}</h3>

            <div class="adeptus-form-row">
                <div class="adeptus-form-group">
                    <label for="site_name">{{#str}}site_name_label, report_adeptus_insights{{/str}} *</label>
                    <input type="text" id="site_name" name="site_name" value="{{site_name}}" readonly>
                    <div class="form-help">{{#str}}your_moodle_site_name, report_adeptus_insights{{/str}}</div>
                </div>

                <div class="adeptus-form-group">
                    <label for="site_url">{{#str}}site_url_label, report_adeptus_insights{{/str}} *</label>
                    <input type="url" id="site_url" name="site_url" value="{{site_url}}" readonly>
                    <div class="form-help">{{#str}}your_moodle_site_url, report_adeptus_insights{{/str}}</div>
                </div>
            </div>
        </div>

        <!-- Administrator Information Section -->
        <div class="adeptus-form-section">
            <h3><i class="fa fa-user"></i> {{#str}}administrator_information, report_adeptus_insights{{/str}}</h3>

            <div class="adeptus-form-row">
                <div class="adeptus-form-group">
                    <label for="admin_name">{{#str}}administrator_name, report_adeptus_insights{{/str}} *</label>
                    <input type="text" id="admin_name" name="admin_name" value="{{admin_name}}" readonly>
                    <div class="form-help">{{#str}}your_full_name_admin, report_adeptus_insights{{/str}}</div>
                </div>

                <div class="adeptus-form-group">
                    <label for="admin_email">{{#str}}administrator_email, report_adeptus_insights{{/str}} *</label>
                    <input type="email" id="admin_email" name="admin_email" value="{{admin_email}}" readonly>
                    <div class="form-help">{{#str}}your_email_account_mgmt, report_adeptus_insights{{/str}}</div>
                </div>
            </div>
        </div>

        <!-- System Information Section -->
        <div class="adeptus-form-section">
            <h3><i class="fa fa-cog"></i> {{#str}}system_information, report_adeptus_insights{{/str}}</h3>

            <div class="adeptus-form-row">
                <div class="adeptus-form-group">
                    <label for="moodle_version">{{#str}}moodle_version, report_adeptus_insights{{/str}} *</label>
                    <input type="text" id="moodle_version" name="moodle_version" value="{{moodle_version}}" readonly>
                    <div class="form-help">{{#str}}your_moodle_version, report_adeptus_insights{{/str}}</div>
                </div>

                <div class="adeptus-form-group">
                    <label for="php_version">{{#str}}php_version, report_adeptus_insights{{/str}} *</label>
                    <input type="text" id="php_version" name="php_version" value="{{php_version}}" readonly>
                    <div class="form-help">{{#str}}your_php_version, report_adeptus_insights{{/str}}</div>
                </div>
            </div>

            <div class="adeptus-form-row">
                <div class="adeptus-form-group">
                    <label for="plugin_version">{{#str}}plugin_version, report_adeptus_insights{{/str}} *</label>
                    <input type="text" id="plugin_version" name="plugin_version" value="{{plugin_version}}" readonly>
                    <div class="form-help">{{#str}}current_plugin_version, report_adeptus_insights{{/str}}</div>
                </div>
            </div>
        </div>

        <!-- Submit Section -->
        <div class="adeptus-submit-section">
            <button type="submit" class="adeptus-submit-btn" id="register-btn">
                <i class="fa fa-check"></i> {{#str}}register_plugin, report_adeptus_insights{{/str}}
            </button>
        </div>
        <!-- Loading Overlay -->
        <div class="adeptus-loading" id="loading-overlay">
            <div class="spinner"></div>
            <p>{{#str}}registering_plugin, report_adeptus_insights{{/str}}</p>
            <p>{{#str}}please_wait_setup, report_adeptus_insights{{/str}}</p>
        </div>
    </form>
    {{/is_registered}}
</div>
